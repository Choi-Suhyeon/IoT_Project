# Chapter07 보조기억장치
<br>

## 07-1 다양한 보조기억장치
### 하드 디스크
<img src="https://github.com/Choi-Suhyeon/IoT_Project/assets/67042526/cf501c59-6726-4c93-af6e-acbc3bb892b0"  width="250">

<br>

- 자기적인 방식으로 데이터를 저장하는 보조기억장치
  - 이 때문에 하드 디스크를 **자기 디스크**의 일종으로 지칭하기도 함
- 생김새는 우리가 아는 CD나 옛날 음향 장치인 LP와 유사하며 실제로도 CD나 LP와 비슷하게 동작
  - 동그란 원판에 데이터를 저장하고, 그것을 회전시켜 뾰족한 리더기로 데이터를 읽는 점에서 비슷

<br>

- 하드 디스크에서 실질적으로 데이터가 저장되는 곳은 그림 속 동그란 원판
  - 이를 **플래터**라고 하며, 플래터는 자기 물질로 덮여 있어 수많은 N극과 S극을 저장
    - N극과 S극은 0과 1의 역할을 수행
- 그 플래터를 회전시키는 구성 요소를 **스핀들**이라고 함
- 스핀들이 플래터를 돌리는 속도는 분당 회전수를 나타내는 **RPM**이라는 단위로 표현

<br>

- 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소는 **헤드**
  - 플래터 위에서 미세하게 떠 있는 채로 데이터를 읽고 쓰는, 마치 바늘같이 생긴 부품
- 헤드는 원하는 위치로 헤드를 이동시키는 **디스크 암**에 부착되어 있음
- 일반적으로 여러 겹의 플래터로 이루어져 있고 플래터 양면을 모두 사용할 수 있음
- 양면 플래터를 사용하면 위아래로 플래터당 두 개의 헤드가 사용되며, 일반적으로 모든 헤드는 디스크 암에 부착되어 다같이 이동

<br>

- 플래터는 **트랙**과 **섹터**라는 단위로 데이터를 저장
- 플래터를 여러 동심원으로 나누었을 때 그 중 하나의 원을 트랙이라고 부름
  - ex) 운동장 달리기 트랙
- 트랙은 마치 피자처럼 여러 조각으로 나누어지는데, 이 한 조각을 섹터라고 부름
- 섹터는 하드 디스크의 가장 작은 전송 단위
- 하나 이상의 섹터를 묶어 **블록**이라고 표현하기도 함
- 여러 겹의 플래터 상에서 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위를 **실린더**라고 함
- 쉽게 말해 한 플래터를 동심원으로 나눈 공간은 트랙, 같은 트랙끼리 연결한 원통 모양의 공간은 실린더

<br>

- 연속된 정보는 보통 한 실린더에 기록
- 예를 들어 두 개의 플래터를 사용하는 하드 디스크에서 네 개 섹터에 걸쳐 데이터를 저장할 때는 첫 번째 플래터 윗면, 뒷면과 두 번째 플래터 윗면, 뒷면에 데이터를 저장
- 연속된 정보를 하나의 실린더에 기록하는 이유는 디스크 암을 움직이지 않고도 바로 데이터에 접근할 수 있기 때문

<br>

- 하드 디스크가 저장된 데이터에 접근하는 시간은 크게 **탐색 시간**, **회전 지연**, **전송 시간**으로 나뉨
- **탐색 시간**은 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간을 의미
- **회전 지연**은 헤드가 있는 곳으로 플래터를 회전시키는 시간을 의미
- **전송 시간**은 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간을 의미
- 탐색 시간과 회전 지연을 단축시키기 위해서는 플래터를 빨리 돌려 RPM을 높이는 것도 중요하지만, 접근하려는 데이터가 플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳에 위치해 있는 것도 중요
  ```
    - 플래터의 한 면당 헤드가 하나씩 달려 있는 하드 디스크를 단일 헤드 디스크(single-head disk)
      - 헤드를 데이터가 있는 곳까지 움직여야 하는 단일 헤드 디스크를 이동 헤드 디스크(movable-head disk)라고도 부름
    - 헤드가 트랙별로 여러개 달려 있는 하드 디스크를 다중 헤드 디스크(multiple-head disk)
      - 다중 헤드 디스크는 트랙마다 헤드가 있기 때문에 탐색 시간이 들지 않음
      - 따라서 다중 헤드 디스크는 탐색 시간이 0
      - 이런 점에서 헤드를 움직일 필요가 없는 다중 헤드 디스크를 고정 헤드 디스크(fixed-head disk)라고도 부름
  ```

<br>

### 플래시 메모리
- 흔히 사용하는 USB 메모리, SD 카드, SSD 모두 플래시 메모리 기반의 보조기억장치
- 플래시 메모리는 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치
  - 플래시 메모리는 보조기억장치 범주에만 속한다기보다는 다양한 곳에서 널리 사용하는 저장 장치로 보는 것이 옳음
    ```
      - 플래시 메모리에는 크게 NAND 플래시 메모리와 NOR 플래시 메모리가 있음
      - NAND 플래시와 NOR 플래시는 각각 NAND 연산을 수행하는 회로(NAND 게이트)와 NOR 연산을 수행하는 회로(NOR 게이트)를 기반으로 만들어진 메모리를 뜻함
      - 이 둘 중 대용량 저장 장치로 많이 사용되는 플래시 메모리는 NAND 플래시 메모리
    ```
- 플래시 메모리에는 **셀**이라는 단위가 있음
  - 셀이란 플래시 메모리에서 데이터를 저장하는 가장 작은 단위
  - 이 셀이 모이고 모여 MB, GB, TB 용량을 갖는 저장 장치가 됨
  - 이 때 하나의 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리 종류가 나뉨
    - 한 셀에 1비트 를 저장할 수 있는 플래시 메모리를 **SLC** 타입, 한 셀에 2비트를 저장할 수 있는 플래시 메모리를 **MLC** 타입, 한 셀에 3비트를 저장할 수 있는 플래시 메모리를 **TLC** 타입이라고 함
    - 큰 차이가 아닌 것처럼 보여도 이는 플래시 메모리의 수명, 속도, 가격에 큰 영향을 끼침
    - 한 셀에 4비트를 저장할 수 있는 QLC 타입도 존재

<br>

- SLC 타입
  - 한 셀로 두 개의 정보를 표현할 수 있음
  - MLC나 TLC 타입에 비해 비트의 빠른 입출력이 가능
  - 수명도 MLC나 TLC 타입보다 길어서 수만에서 수십만 번 가까이 데이터를 쓰고 지우고를 반복 가능
  - 하지만 SLC 타입은 용량 대비 가격이 높음
  - 보통 기업에서 데이터를 읽고 쓰기가 매우 많이 반복되며 고성능의 빠른 저장 장치가 필요한 경우에 SLC 타입을 사용

<br>

- MLC 타입
  - 한 셀로 네 개의 정보를 표현할 수 있음
  - SLC 타입보다 일반적으로 속도와 수명은 떨어지지만, 한 셀에 두 비트씩 저장할 수 있다는 점에서 MLC 타입은 SLC 타입 보다 대용화하기 유리
  - MLC 타입은 SLC 타입보다 용량 대비 가격이 저렴
  - 시중에서 사용되는 많은 플래시 메모리 저장 장치들이 MLC 타입(혹은 TLC 타입)으로 만들어짐

<br>

- TLC 타입
  - 한 셀당 3비트씩 저장할 수 있고 한 셀로 여덟 개의 정보를 표현할 수 있음
  - 그렇기에 대용량화 하기가 유리
  - 일반적으로 SLC나 MLC 타입보다 수명과 속도가 떨어지지만 용량 대비 가격도 저렴

<br>

- 셀들이 모여 만들어진 단위를 **페이지**, 페이지가 모여 만들어진 단위를 **블록**, 블록이 모여 **플레인**, 플레인이 모여 **다이**가 됨
- 플래시 메모리에서 읽기와 쓰기는 페이지 단위로 이루어짐
- 하지만 삭제는 페이지보다 큰 블록 단위로 이루어짐
- 읽기/쓰기 단위와 삭제 단위가 다르다는 것이 플래시 메모리의 가장 큰 특징 중 하나
- 이때 페이지는 세 개의 상태를 가질 수 있으며, 이는 각각 Free, Valid, Invalid 상태
  - **Free 상태**는 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태를 의미
  - **Valid 상태**는 이미 유효한 데이터를 저장하고 있는 상태를 의미
  - **Invalid 상태**는 쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태를 의미
  - 플래시 메모리는 하드 디스크와는 달리 덮어쓰기가 불가능하여 Valid 상태인 페이지에는 새 데이터를 저장할 수 없음

<br>

- 최근 SSD를 비롯한 플래시 메모리는 쓰레기값을 정리하기 위해 **가비지 컬렉션** 기능을 제공
  ```
    1. 유효한 페이지들만을 새로운 블록으로 복사한 뒤,
    2. 기존의 블록을 삭제하는 기능
    => 즉, 블록 X의 모든 유효한 페이지를 새로운 블록 Y로 옮기고 블록 X를 삭제
  ```

<br><br><br>

## 07-2 RAID의 정의와 종류
### RAID의 정의
- 주로 하드 디스크와 SSD를 사용하는 기술로, 데이터의 안전성 혹은 높은 성능을 위해 여러 개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술을 의미

<br>

### RAID의 종류
- RAID 구성 방법을 **RAID 레벨**이라 표현하는데, RAID 레벨에는 대표적으로 RAID 0, RAID 1, RAID 2, RAID 3, RAID 4, RAID 5, RAID 6이 있고, 그로부터 파생된 RAID 10, RAID 50 등이 있음

<br>

- RAID 0
  - 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식
  - 저장되는 데이터가 하드 디스크 개수만큼 나뉘어 저장됨
  - 마치 줄무늬처럼 분산되어 저장된 데이터를 **스트라입**이라 하고, 분산하여 저장하는 것을 **스트라이핑**이라고 함
  - 데이터가 분산되어 저장되면, 다시 말해 스트라이핑되면 저장된 데이터를 읽고 쓰는 속도가 빨라짐
  - 단점
    - 저장된 정보가 안전하지 않음
    - RAID 0으로 구성된 하드 디스크 중 하나에 문제가 생긴다면 다른 모든 하드 디스크의 정보를 읽는데 문제가 생길 수 있음

<br>

- RAID 1
  - 복사본을 만드는 방식
  - 마치 거울처럼 완전한 복사본을 만드는 구성이기에 **미러링**이라고도 부름
  - RAID 1에 어떠한 데이터를 쓸 때는 원본과 복사본 두 군데에 쓰기 때문에 쓰기 속도는 RAID 0보다 느림
  - 복구가 매우 간단하다는 장점이 있음
    - 똑같은 디스크가 두 개 있는 셈이니, 하나에 문제가 발생해도 잃어버린 정보를 금방 되찾을 수 있기 때문
  - 단점
    - 하드 디스크 개수가 한정되었을 때 사용 가능한 용량이 적어짐
    - 결국 많은 양의 하드 디스크가 필요하게 되고, 비용이 증가한다는 단점

<br>

- RAID 4
  - RAID 1처럼 완전한 복사본을 만드는 대신 오류를 검출하고 복구하기 위한 정보를 저장한 장치를 두는 구성 방식
  - ‘오류를 검출하고 복구하기 위한 정보’를 **패리티 비트**라고 함
  - 패리티를 저장한 장치를 이용해 다른 장치들의 오류를 검출하고, 오류가 있다면 복구
  - RAID 1보다 적은 하드 디스크로도 데이터를 안전하게 보관 할 수 있음
  - 어떤 새로운 데이터가 저장될 때마다 패리티를 저장하는 디스크에도 데이터를 쓰게 되므로 패리티를 저장하는 장치에 병목 현상이 발생
  - 원래 패리티 비트는 오류 검출만 가능할 뿐 오류 복구는 불가능, 하지만 RAID에서는 패리티 값으로 오류 수정도 가능

<br>

- RAID 5
  - 패리티 정보를 분산하여 저장하는 방식으로 RAID 4의 문제인 병목 현상을 해소

<br>

- RAID 6
  - 구성은 기본적으로 RAID 5와 같으나, 서로 다른 두 개의 패리티를 두는 방식
  - 이는 오류를 검출하고 복구할 수 있는 수단이 두 개가 생긴 셈이기 때문에 RAID 6은 RAID 4나 RAID 5보다 안전한 구성이라 볼 수 있음
  - 다만 새로운 정보를 저장할 때마다 함께 저장할 패리티가 두 개이므로, 쓰기 속도는 RAID 5보다 느림
  - 따라서 RAID 6은 데이터 저장 속도를 조금 희생하더라도 데이터를 더욱 안전하게 보관하고 싶을때 사용하는 방식
  
