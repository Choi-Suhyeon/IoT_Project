# 13. Deadlock

## 교착 상태 
### 의미
다른 구성원이 메세지를 보내거나 lock을 해제하는 등의 조치를 취할 때까지 대기하기 때문에 그룹의 어떤 구성원도 진행할 수 없는 상황을 의미. 운영체제에서는 요청된 시스템 자원이 다른 대기 프로세스에 의해 유지되고, 해당 대기 프로세스가 또 다른 대기 프로세스에 의해 유지되는 다른 리소스를 대기하고 있을 때 발생.

### 발생 조건(필요 조건)
- 상호 배제 : 자원을 하나의 프로세스만 이용 가능. (한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없을 때).
- 점유와 대기 : 적어도 하나의 자원을 점유한 상태에서 이미 다른 프로세스가 점유하고 있는 자원을 추가적으로 요구.
- 비선점 : 프로세스가 자신이 소유한 자원의 사용을 끝낼 때까지 해당 자원을 뺏어 사용할 수 없음.
- 순환 대기 : 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 소유.

## 해결 방법
### 예방
예방은 위의 필요 조건들 중 하나를 막는 것으로 접근.

**상호 배제 제거** : 자원을 공유하면 됨. read-only면 가능하지만, 현실적으로 모든 값을 read-only로 두는 것은 힘듬.

**점유와 대기 제거** : 프로세스가 수행되기 전에 필요한 모든 자원을 요청. 자주 이러한 상황을 만들기 어렵고 자원 사용도 비효율적. 특별히 인기 있는 자원이 존재하거나 많은 자원을 사용하는 프로세스가 있으면, 기아 현상(자원을 계속 할당받지 못하는 상태)을 야기할 수 있음.

**비선점 제거** : 이름 그대로 사용 중인 자원을 뺏을 수 있도록 해주는 것이지만, 그것이 안 되는 자원도 많음.

**순환 대기 제거** : 자원의 순서를 결정하기 위한 계층 구조를 사용해 오름차순으로 요청하면 됨. 만약 명확한 계층 구조가 존재하지 않으면 자원의 메모리 주소조차도 이용할 수도 있음.

### 회피
**은행원 알고리즘** : 각 프로세스가 최대로 필요한 자원의 종류와 개수, 특정 시점에 프로세스가 빌린 자원, 운영체제에 남은 필요한 자원을 알고 있는 상황에서 불안전 상태가 발생할 위험이 있으면 자원을 할당을 해주지 않는 것.

불안전 상태 : 교착 상태가 발생할 수도 있는 상황. 즉, 빌려주고 남은 자원을 모두 부어서 한 프로세스 끝내고 연쇄적으로 다른 프로세스들도 끝낼 수 있으면 안전 상태, 그렇지 않으면 불안전 상태.

자원의 수, 프로세스의 수가 일정해야 하고 자원 이용도가 낮다는 단점이 있음.
### 발견
**선점을 통한 회복** : 말 그대로 교착 상태가 해결될 때까지 하나의 프로세스씩 자원을 몰아주는 방식.

**프로세스 강제 종료** : 교착 상태가 해결될 때까지 하나씩 종료하거나 교착 상태에 빠진 모든 프로세스를 모두 강제 종료.

### 무시
드물게 발생하는 잠재적 문제를 무시.